<!DOCTYPE html >
<html lang="en" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/layout.html}"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.ultraq.net.nz/thymeleaf/layout ">
<head>
    <meta charset="UTF-8">

    <title th:text="${noteName}"></title>

    <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/easymde/dist/easymde.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/easymde/dist/easymde.min.js"></script>

</head>
<body>
<main>
    <section layout:fragment="content" class="grid bg-gray-100 min-h-dvh pt-[45px]"  th:classappend="${isOwner == true} ? 'lg:grid-cols-[1fr_280px]' : ' ' " >
        <div>
            <form method="POST">
                <input type="text" name="noteName" th:value="${file.name}">
                <textarea id="main-editor" ></textarea>
                <input type="hidden" id="noteText" name="noteText" >
                <!--/*@thymesVar id="noteUUID" type="java.lang.String"*/-->
                <input type="hidden" name="noteUUID" th:value="${file.id}" >
                <!--/*@thymesVar id="noteFolderUUID" type="java.lang.String"*/-->
                <input type="hidden" name="folderUUID" th:value="${file.folderEntity.id}" >
                <button hx-post="" hx-swap="outerHTML" >Save</button>
            </form>
            <script th:inline="javascript">
                /*<![CDATA[*/
                const easymde = new EasyMDE({
                    initialValue: /*[[${file.text}]]*/ "# Hello",
                    element: document.getElementById('main-editor'),
                });
                const textEl = document.getElementById("noteText");
                textEl.value = easymde.value();
                easymde.codemirror.on("change", ()=> {
                        textEl.value = easymde.value()
                    }
                )
                /*]]>*/
            </script>
        </div>
        <div th:if="${isOwner==true}">
            <div layout:replace="~{fragments/files/notes/control}">

            </div>

        </div>



    </section>
</main>
</body>
</html>